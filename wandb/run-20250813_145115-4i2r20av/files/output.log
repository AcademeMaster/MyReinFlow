正在加载数据集: mujoco/pusher/expert-v0
开始训练...
d:\PycharmProjects\MyReinFlow\behavioral_cloning.py:213: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(enabled=(self.device.type == 'cuda' and self.config.use_amp))
Epoch 1/50:   0%|                                                                       | 0/20 [00:00<?, ?it/s]d:\PycharmProjects\MyReinFlow\behavioral_cloning.py:346: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=(self.device.type == 'cuda' and self.config.use_amp)):

Epoch 1/50:  95%|██████████████████████████████████████████████████████████▉   | 19/20 [00:05<00:00,  4.71it/s]
Epoch 1/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.49it/s]

Epoch 2/50:  95%|██████████████████████████████████████████████████████████▉   | 19/20 [00:03<00:00,  4.83it/s]
Epoch 2/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.96it/s]

Epoch 3/50:  90%|███████████████████████████████████████████████████████▊      | 18/20 [00:04<00:00,  4.39it/s]
Epoch 3/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]

Epoch 4/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.50it/s]
Epoch 5/50:  25%|███████████████▊                                               | 5/20 [00:01<00:03,  4.42it/s]


Epoch 5/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.53it/s]
Epoch 5/50, Loss: 0.020031
Epoch 6/50:  15%|█████████▍                                                     | 3/20 [00:00<00:04,  3.83it/s]

Epoch 6/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.96it/s]
Epoch 7/50:   0%|                                                                       | 0/20 [00:00<?, ?it/s]


Epoch 7/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.85it/s]
Epoch 8/50:  15%|█████████▍                                                     | 3/20 [00:00<00:04,  3.73it/s]


Epoch 8/50:  95%|██████████████████████████████████████████████████████████▉   | 19/20 [00:05<00:00,  3.57it/s]
Epoch 8/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.87it/s]

Epoch 9/50: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.70it/s]
Epoch 10/50:   0%|                                                                      | 0/20 [00:00<?, ?it/s]



Epoch 10/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.94it/s]
Epoch 10/50, Loss: 0.019178
Epoch 11/50:   0%|                                                                      | 0/20 [00:00<?, ?it/s]


Epoch 11/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.98it/s]
Epoch 12/50:  20%|████████████▍                                                 | 4/20 [00:01<00:04,  3.80it/s]


Epoch 12/50:  95%|█████████████████████████████████████████████████████████▉   | 19/20 [00:04<00:00,  4.02it/s]
Epoch 12/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.01it/s]

Epoch 13/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.08it/s]
Epoch 14/50:  20%|████████████▍                                                 | 4/20 [00:01<00:04,  3.83it/s]

Epoch 14/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.07it/s]
Epoch 15/50:   5%|███                                                           | 1/20 [00:00<00:04,  3.93it/s]


Epoch 15/50:  90%|██████████████████████████████████████████████████████▉      | 18/20 [00:04<00:00,  4.05it/s]

Epoch 15/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.15it/s]
Epoch 16/50:   0%|                                                                      | 0/20 [00:00<?, ?it/s]


Epoch 16/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  4.00it/s]
Epoch 17/50:  25%|███████████████▌                                              | 5/20 [00:01<00:03,  4.15it/s]

Epoch 17/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.96it/s]
Epoch 18/50:   5%|███                                                           | 1/20 [00:00<00:06,  3.15it/s]


Epoch 18/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.95it/s]
Epoch 19/50:  25%|███████████████▌                                              | 5/20 [00:01<00:04,  3.39it/s]


Epoch 19/50:  90%|██████████████████████████████████████████████████████▉      | 18/20 [00:04<00:00,  3.72it/s]
Epoch 19/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.83it/s]


Epoch 20/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  4.00it/s]
Epoch 20/50, Loss: 0.018524
评估结果 - 平均回报: -38.75 ± 8.87

Epoch 21/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.93it/s]
Epoch 22/50:  15%|█████████▎                                                    | 3/20 [00:00<00:04,  4.06it/s]


Epoch 22/50:  85%|███████████████████████████████████████████████████▊         | 17/20 [00:04<00:00,  3.99it/s]
Epoch 22/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.04it/s]

Epoch 23/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.94it/s]
Epoch 24/50:  10%|██████▏                                                       | 2/20 [00:00<00:04,  3.66it/s]


Epoch 24/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.01it/s]
Epoch 25/50:  30%|██████████████████▌                                           | 6/20 [00:01<00:03,  3.84it/s]


Epoch 25/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.93it/s]
Epoch 25/50, Loss: 0.018378
评估结果 - 平均回报: -36.24 ± 8.31

Epoch 26/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.14it/s]
Epoch 27/50:   5%|███                                                           | 1/20 [00:00<00:05,  3.79it/s]


Epoch 27/50:  85%|███████████████████████████████████████████████████▊         | 17/20 [00:04<00:00,  3.87it/s]
Epoch 27/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:05<00:00,  3.96it/s]

Epoch 28/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.02it/s]
Epoch 29/50:  10%|██████▏                                                       | 2/20 [00:00<00:04,  3.69it/s]


Epoch 29/50:  90%|██████████████████████████████████████████████████████▉      | 18/20 [00:04<00:00,  4.03it/s]
Epoch 29/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.01it/s]


Epoch 30/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.03it/s]
Epoch 30/50, Loss: 0.018253
Epoch 31/50:   5%|███                                                           | 1/20 [00:00<00:04,  4.45it/s]


Epoch 31/50:  85%|███████████████████████████████████████████████████▊         | 17/20 [00:03<00:00,  4.45it/s]
Epoch 31/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]

Epoch 32/50:  75%|█████████████████████████████████████████████▊               | 15/20 [00:03<00:01,  4.42it/s]
Epoch 32/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]

Epoch 33/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Epoch 34/50:  20%|████████████▍                                                 | 4/20 [00:00<00:03,  4.39it/s]

Epoch 34/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.49it/s]
Epoch 35/50:  10%|██████▏                                                       | 2/20 [00:00<00:04,  4.48it/s]


Epoch 35/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.51it/s]
Epoch 35/50, Loss: 0.018154
Epoch 36/50:  20%|████████████▍                                                 | 4/20 [00:00<00:03,  4.44it/s]

Epoch 36/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.53it/s]
Epoch 37/50:   5%|███                                                           | 1/20 [00:00<00:04,  4.44it/s]


Epoch 37/50:  95%|█████████████████████████████████████████████████████████▉   | 19/20 [00:04<00:00,  4.41it/s]
Epoch 37/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.52it/s]

Epoch 38/50:  85%|███████████████████████████████████████████████████▊         | 17/20 [00:03<00:00,  4.44it/s]
Epoch 38/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.53it/s]

Epoch 39/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.52it/s]
Epoch 40/50:  25%|███████████████▌                                              | 5/20 [00:01<00:03,  4.41it/s]


Epoch 40/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.53it/s]
Epoch 40/50, Loss: 0.018080
评估结果 - 平均回报: -34.49 ± 6.85

Epoch 41/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Epoch 42/50:  20%|████████████▍                                                 | 4/20 [00:00<00:03,  4.37it/s]

Epoch 42/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch 43/50:  10%|██████▏                                                       | 2/20 [00:00<00:04,  4.40it/s]

Epoch 43/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.34it/s]
Epoch 44/50:   0%|                                                                      | 0/20 [00:00<?, ?it/s]


Epoch 44/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.25it/s]
Epoch 45/50:  30%|██████████████████▌                                           | 6/20 [00:01<00:03,  4.04it/s]


Epoch 45/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.22it/s]
Epoch 45/50, Loss: 0.018003
评估结果 - 平均回报: -33.37 ± 6.61

Epoch 46/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.50it/s]
Epoch 47/50:  15%|█████████▎                                                    | 3/20 [00:00<00:03,  4.36it/s]

Epoch 47/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.51it/s]
Epoch 48/50:  10%|██████▏                                                       | 2/20 [00:00<00:04,  4.39it/s]

Epoch 48/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.51it/s]
Epoch 49/50:   0%|                                                                      | 0/20 [00:00<?, ?it/s]


Epoch 49/50:  90%|██████████████████████████████████████████████████████▉      | 18/20 [00:04<00:00,  4.43it/s]
Epoch 49/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.51it/s]


Epoch 50/50: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.52it/s]
Epoch 50/50, Loss: 0.017948
评估结果 - 平均回报: -33.41 ± 10.22
模型已保存到: bc_model_mujoco_pusher_expert-v0.pth